attack_technique: T1027.002
display_name: 'Obfuscated Files or Information: Software Packing'
atomic_tests:
- name: Binary simply packed by UPX
  auto_generated_guid: 2ce996ec-305b-4301-aef7-9eda826bc32e
  description: |
    Copies and then runs a simple binary (just outputting "the cake is a lie"), that was packed by UPX.
    No other protection/compression were applied.
  supported_platforms:
  - windows
  input_arguments:
    bin_path:
      description: Packed binary
      type: Path
      default: PathToAtomicsFolder/T1027.002A/src/upx.exe
    file_path:
      description: Packed binary
      type: Path
      default: PathToAtomicsFolder/T1027.002A/src/PsExec.exe      
  executor:
    command: |
      #{bin_path} -1 #{file_path}
      #{file_path}
    cleanup_command: |
      #{bin_path} -d #{file_path}
    name: command_prompt
